workflow:
  id: brownfield-discovery
  name: Brownfield Discovery
  description: >
    10-phase technical debt assessment for existing codebases.
    Phases 1-3 can run in parallel (data collection).

phases:
  # Data Collection (parallel)
  - id: architecture-scan
    name: Architecture Scan
    agent: architect
    task: document-project.md
    parallel_with: [db-audit, frontend-scan]
    next: draft-assessment

  - id: db-audit
    name: Database Audit
    agent: data-engineer
    task: db-schema-audit.md
    skip_if: "no database in project"
    parallel_with: [architecture-scan, frontend-scan]
    next: draft-assessment

  - id: frontend-scan
    name: Frontend Scan
    agent: ux-designer
    task: ux-scan-artifact.md
    skip_if: "no frontend in project"
    parallel_with: [architecture-scan, db-audit]
    next: draft-assessment

  # Assessment
  - id: draft-assessment
    name: Draft Assessment
    agent: architect
    task: document-project.md
    next: qa-review

  - id: qa-review
    name: QA Review
    agent: qa
    task: qa-gate.md
    decision:
      APPROVED: finalize
      NEEDS_WORK: draft-assessment
    next: finalize

  - id: finalize
    name: Create Epics
    agent: pm
    task: create-epic.md
    next: done

flow: |
  ┌─ @architect scan ─┐
  ├─ @data-eng audit  ─┤ -> @architect draft -> @qa review -> @pm epics
  └─ @ux-designer scan─┘         |                  |
                            NEEDS_WORK <─────── NEEDS_WORK
